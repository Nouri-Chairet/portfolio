import React, { useEffect, useRef } from 'react';
import { gsap } from 'gsap';
import { MotionPathPlugin } from 'gsap/MotionPathPlugin';
import DrawSVGPlugin from 'gsap/DrawSVGPlugin';
gsap.registerPlugin(MotionPathPlugin);
gsap.registerPlugin(DrawSVGPlugin);

const HandwritingSVG = () => {
  let timeMinus = 0.02;
  const pathRefs = useRef([]);
  const svgRef = useRef();

  useEffect(() => {
    let tl = gsap.timeline();
    const n = pathRefs.current.length;
    const mid = Math.floor(n / 2);

    for (let i = 0; i < mid; i++) {
      [pathRefs.current[i], pathRefs.current[n - 1 - i]].forEach(ref => {
        gsap.set(ref, { fill: 'none' });
      });
      tl.fromTo(
        [pathRefs.current[i], pathRefs.current[n - 1 - i]],
        { drawSVG: '0% 0%' },
        { drawSVG: '0% 100%', duration: 0.35 - timeMinus * i, ease: 'power1.inOut' },
        i === 0 ? 0.35 - timeMinus * i : '>'
      );
      tl.to(
        [pathRefs.current[i], pathRefs.current[n - 1 - i]],
        { fill: '#fff', duration: 0.24 - timeMinus * i, ease: 'circ.in' },
        '>'
      );
    }

    if (n % 2 === 1) {
      const midRef = pathRefs.current[mid];
      gsap.set(midRef, { fill: 'none' });
      tl.fromTo(
        midRef,
        { drawSVG: '0% 0%' },
        { drawSVG: '0% 100%', duration: 0.5, ease: 'power1.inOut' },
        '>'
      );
      tl.to(
        midRef,
        { fill: '#fff', duration: 0.2, ease: 'circ.in' },
        '>'
      );
    }

    return () => {
      if (tl) tl.kill();
    };
  }, []);

  return (
    <svg ref={svgRef} style={{ width: "50%", height: "50%" }} viewBox="0 0 863 164" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path ref={el => (pathRefs.current[0] = el)} d="M7.296 124V34.4H32.128L67.968 92.896H54.912L89.728 34.4H114.56L114.816 124H87.296L87.04 75.872H91.392L67.584 115.936H54.272L29.44 75.872H34.816V124H7.296Z" fill="none" stroke="#fff" strokeWidth="2" />
      <path ref={el => (pathRefs.current[1] = el)} d="M148.76 150.112C144.92 150.112 140.995 149.515 136.984 148.32C133.059 147.211 129.901 145.717 127.512 143.84L137.112 124C138.563 125.109 140.184 126.005 141.976 126.688C143.853 127.371 145.645 127.712 147.352 127.712C149.912 127.712 151.875 127.157 153.24 126.048C154.605 125.024 155.715 123.445 156.568 121.312L159.512 113.888L161.56 111.072L183.96 53.984H211.352L182.552 125.408C179.992 131.808 177.005 136.8 173.592 140.384C170.264 143.968 166.509 146.485 162.328 147.936C158.232 149.387 153.709 150.112 148.76 150.112ZM155.544 127.2L125.08 53.984H154.776L175.768 108.512L155.544 127.2Z" fill="none" stroke="#fff" strokeWidth="2" />
      <path ref={el => (pathRefs.current[2] = el)} d="M266.296 124V34.4H309.432C317.795 34.4 325.005 35.7653 331.064 38.496C337.208 41.2267 341.944 45.152 345.272 50.272C348.6 55.3067 350.264 61.28 350.264 68.192C350.264 75.104 348.6 81.0773 345.272 86.112C341.944 91.1467 337.208 95.072 331.064 97.888C325.005 100.619 317.795 101.984 309.432 101.984H283.064L296.504 89.056V124H266.296ZM296.504 92.384L283.064 78.688H307.512C311.693 78.688 314.765 77.7493 316.728 75.872C318.776 73.9947 319.8 71.4347 319.8 68.192C319.8 64.9493 318.776 62.3893 316.728 60.512C314.765 58.6347 311.693 57.696 307.512 57.696H283.064L296.504 44V92.384Z" fill="none" stroke="#fff" strokeWidth="2" />
      <path ref={el => (pathRefs.current[3] = el)} d="M365.4 124V53.984H392.92V75.104L388.44 69.088C390.573 63.6267 393.987 59.5307 398.68 56.8C403.373 54.0693 409.005 52.704 415.576 52.704V78.304C414.296 78.1333 413.144 78.0053 412.12 77.92C411.181 77.8347 410.2 77.792 409.176 77.792C404.824 77.792 401.24 78.944 398.424 81.248C395.693 83.4667 394.328 87.3493 394.328 92.896V124H365.4Z" fill="none" stroke="#fff" strokeWidth="2" />
      <path ref={el => (pathRefs.current[4] = el)} d="M469.392 125.28C461.456 125.28 454.416 123.744 448.272 120.672C442.213 117.515 437.435 113.205 433.936 107.744C430.437 102.283 428.688 96.0107 428.688 88.928C428.688 81.8453 430.437 75.5733 433.936 70.112C437.435 64.6507 442.213 60.384 448.272 57.312C454.416 54.24 461.456 52.704 469.392 52.704C477.328 52.704 484.368 54.24 490.512 57.312C496.656 60.384 501.435 64.6507 504.848 70.112C508.347 75.5733 510.096 81.8453 510.096 88.928C510.096 96.0107 508.347 102.283 504.848 107.744C501.435 113.205 496.656 117.515 490.512 120.672C484.368 123.744 477.328 125.28 469.392 125.28ZM469.392 102.752C471.525 102.752 473.445 102.24 475.152 101.216C476.859 100.192 478.224 98.656 479.248 96.608C480.272 94.4747 480.784 91.9147 480.784 88.928C480.784 85.856 480.272 83.3387 479.248 81.376C478.224 79.328 476.859 77.792 475.152 76.768C473.445 75.744 471.525 75.232 469.392 75.232C467.259 75.232 465.339 75.744 463.632 76.768C461.925 77.792 460.56 79.328 459.536 81.376C458.512 83.3387 458 85.856 458 88.928C458 91.9147 458.512 94.4747 459.536 96.608C460.56 98.656 461.925 100.192 463.632 101.216C465.339 102.24 467.259 102.752 469.392 102.752Z" fill="none" stroke="#fff" strokeWidth="2" />
      <path ref={el => (pathRefs.current[5] = el)} d="M522.76 158.112C519.347 158.112 516.104 157.813 513.032 157.216C509.875 156.619 507.187 155.765 504.968 154.656L511.88 134.56C513.928 135.669 516.104 136.224 518.408 136.224C520.115 136.224 521.523 135.584 522.632 134.304C523.827 133.024 524.424 130.976 524.424 128.16V61.984H553.352V128.416C553.352 137.461 550.664 144.672 545.288 150.048C539.912 155.424 532.403 158.112 522.76 158.112ZM538.888 56.352C533.597 56.352 529.373 54.944 526.216 52.128C523.059 49.312 521.48 45.8133 521.48 41.632C521.48 37.4507 523.059 33.952 526.216 31.136C529.373 28.32 533.597 26.912 538.888 26.912C544.179 26.912 548.403 28.2347 551.56 30.88C554.717 33.5253 556.296 36.9387 556.296 41.12C556.296 45.5573 554.717 49.2267 551.56 52.128C548.403 54.944 544.179 56.352 538.888 56.352Z" fill="none" stroke="#fff" strokeWidth="2" />
      <path ref={el => (pathRefs.current[6] = el)} d="M607.056 125.28C598.523 125.28 591.056 123.701 584.656 120.544C578.341 117.387 573.435 113.077 569.936 107.616C566.437 102.069 564.688 95.84 564.688 88.928C564.688 81.8453 566.395 75.5733 569.808 70.112C573.307 64.6507 578.043 60.384 584.016 57.312C590.075 54.24 596.859 52.704 604.368 52.704C611.28 52.704 617.637 54.0693 623.44 56.8C629.328 59.5307 634.021 63.584 637.52 68.96C641.104 74.336 642.896 80.992 642.896 88.928C642.896 89.952 642.853 91.104 642.768 92.384C642.683 93.5787 642.597 94.688 642.512 95.712H588.624V81.76H627.152L616.272 85.472C616.272 82.7413 615.76 80.4373 614.736 78.56C613.797 76.5973 612.475 75.104 610.768 74.08C609.061 72.9707 607.013 72.416 604.624 72.416C602.235 72.416 600.144 72.9707 598.352 74.08C596.645 75.104 595.323 76.5973 594.384 78.56C593.445 80.4373 592.976 82.7413 592.976 85.472V89.824C592.976 92.8107 593.573 95.3707 594.768 97.504C595.963 99.6373 597.669 101.259 599.888 102.368C602.107 103.392 604.795 103.904 607.952 103.904C611.195 103.904 613.84 103.477 615.888 102.624C618.021 101.771 620.24 100.491 622.544 98.784L637.648 114.016C634.235 117.685 630.011 120.501 624.976 122.464C620.027 124.341 614.053 125.28 607.056 125.28Z" fill="none" stroke="#fff" strokeWidth="2" />
      <path ref={el => (pathRefs.current[7] = el)} d="M690.032 125.28C682.011 125.28 674.885 123.744 668.656 120.672C662.427 117.6 657.52 113.333 653.936 107.872C650.437 102.325 648.688 96.0107 648.688 88.928C648.688 81.8453 650.437 75.5733 653.936 70.112C657.52 64.6507 662.427 60.384 668.656 57.312C674.885 54.24 682.011 52.704 690.032 52.704C698.565 52.704 705.861 54.5387 711.92 58.208C717.979 61.8773 722.16 66.9547 724.464 73.44L702.064 84.448C700.613 81.2053 698.821 78.8587 696.688 77.408C694.64 75.9573 692.379 75.232 689.904 75.232C687.771 75.232 685.765 75.744 683.888 76.768C682.096 77.792 680.645 79.328 679.536 81.376C678.512 83.3387 678 85.856 678 88.928C678 92 678.512 94.56 679.536 96.608C680.645 98.656 682.096 100.192 683.888 101.216C685.765 102.24 687.771 102.752 689.904 102.752C692.379 102.752 694.64 102.027 696.688 100.576C698.821 99.1253 700.613 96.7787 702.064 93.536L724.464 104.544C722.16 111.029 717.979 116.107 711.92 119.776C705.861 123.445 698.565 125.28 690.032 125.28Z" fill="none" stroke="#fff" strokeWidth="2" />
      <path ref={el => (pathRefs.current[8] = el)} d="M765.192 125.28C755.549 125.28 748.04 122.976 742.664 118.368C737.288 113.675 734.6 106.507 734.6 96.864V38.24H763.528V96.608C763.528 98.7413 764.083 100.405 765.192 101.6C766.387 102.795 767.837 103.392 769.544 103.392C772.019 103.392 774.195 102.752 776.072 101.472L782.984 121.568C780.765 122.848 778.077 123.787 774.92 124.384C771.848 124.981 768.605 125.28 765.192 125.28ZM725 78.944V57.824H777.864V78.944H725Z" fill="none" stroke="#fff" strokeWidth="2" />
      <path ref={el => (pathRefs.current[9] = el)} d="M823.792 125.28C817.819 125.28 811.931 124.64 806.128 123.36C800.325 122.08 795.632 120.416 792.048 118.368L799.984 99.296C803.312 101.259 807.152 102.795 811.504 103.904C815.941 105.013 820.251 105.568 824.432 105.568C827.931 105.568 830.277 105.269 831.472 104.672C832.752 104.075 833.392 103.264 833.392 102.24C833.392 101.216 832.667 100.491 831.216 100.064C829.765 99.552 827.845 99.168 825.456 98.912C823.067 98.656 820.421 98.3573 817.52 98.016C814.704 97.5893 811.845 96.992 808.944 96.224C806.043 95.456 803.397 94.304 801.008 92.768C798.619 91.232 796.699 89.184 795.248 86.624C793.797 83.9787 793.072 80.6507 793.072 76.64C793.072 72.2027 794.395 68.192 797.04 64.608C799.771 61.024 803.781 58.1653 809.072 56.032C814.448 53.8133 821.061 52.704 828.912 52.704C834.032 52.704 839.152 53.1733 844.272 54.112C849.392 55.0507 853.787 56.5013 857.456 58.464L849.52 77.536C845.936 75.5733 842.395 74.2507 838.896 73.568C835.483 72.8 832.283 72.416 829.296 72.416C825.627 72.416 823.109 72.7573 821.744 73.44C820.464 74.1227 819.824 74.8907 819.824 75.744C819.824 76.768 820.549 77.536 822 78.048C823.451 78.56 825.371 78.944 827.76 79.2C830.149 79.456 832.752 79.7973 835.568 80.224C838.469 80.5653 841.328 81.1627 844.144 82.016C847.045 82.784 849.691 83.936 852.08 85.472C854.469 87.008 856.389 89.0987 857.84 91.744C859.291 94.304 860.016 97.5893 860.016 101.6C860.016 105.781 858.693 109.707 856.048 113.376C853.403 116.96 849.392 119.861 844.016 122.08C838.64 124.213 831.899 125.28 823.792 125.28Z" fill="none" stroke="#fff" strokeWidth="2" />
    </svg>
  );
};

export default HandwritingSVG;
